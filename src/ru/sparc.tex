\documentclass[a4paper,twoside]{book}

\emergencystretch=1em
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{fontspec}
\usepackage{graphicx}
\renewcommand{\thefigure}{\thesection.\arabic{figure}}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage[absolute,overlay,showboxes]{textpos}
\usepackage{etoolbox}
\usepackage{longtable}
\usepackage{tikz}
\usepackage{lilyglyphs}
\usepackage{tabularx}
\usepackage{pgfplots}
\usepackage{circuitikz}
\usepackage{minted}
\usepackage{glossaries}
\usepackage{makeidx}
\usepackage{expl3}
\usepackage{chngcntr}
\usepackage{svg}
\usepackage{subfiles}
\usepackage[printonlyused,withpage]{acronym}

\usepackage[backend=bibtex]{biblatex}
\addbibresource{references.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setmainfont{Liberation Serif}
\setmonofont{Liberation Mono}

\makeindex
\makeglossaries

\urlstyle{same}

\graphicspath{ {images/} {../../../images/} {../../../out/src/common/} }

\input{sections/commands.tex}
\input{common/figureSoundGraph.tex}
\input{common/figurePWMGraph.tex}
\input{common/figureADC.tex}
\input{common/figureAnalogSignalExample.tex}
\input{common/figureDigitalSignalExample.tex}
\input{src/common/figureBlinkinLEDGraph.tex}
\input{src/common/figureMusicSixBars.tex}
\input{common/figureMusicSixBarsFourFour.tex}
\input{common/figureMusicBarFourFour.tex}
\input{common/figureMusicBarFourFourWithFrequencies.tex}
\input{common/figureMusicWeWillRockYouSimplified.tex}
\input{common/tableTwoDimensionalArray.tex}
\input{common/tableMusicNoteLengths.tex}
\input{common/figureMusicTwinkleTwinkleLittleStar.tex}
\input{common/tableMusicTwinkleTwinkleLittleStar.tex}

\counterwithin{listing}{section}
\renewcommand\listingscaption{Листинг}

\newgetenv[\REPRODUCIBILITY]{REPRODUCIBILITY}%
\newgetenv[\RANDOMSEED]{RANDOMSEED}

\ifdefstring{\REPRODUCIBILITY}{yes}{%
  \ifthenelse{\equal{\RANDOMSEED}{}}%
  {%
    \typeout{Setting the random seed to a fixed value.}%
    \pgfmathsetseed{\number42}%
  }{%
    \typeout{Setting the random seed to a \RANDOMSEED .}%
    \pgfmathsetseed{\number\RANDOMSEED}%
  }%
}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Автомато-программато-компарадио-кружок}
\author{Артём ``avp'' Попцов\\\href{https://memory-heap.org}{memory-heap.org}}
\input{version.tex}

\begin{document}

\maketitle

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Вступление}
\addcontentsline{toc}{chapter}{Вступление}

\subfile{sections/introduction.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Основы электроники}

В первую очередь нам с вами надо рассмотреть базовые принципы того, как работает
электроника, чтобы впоследствии уметь собирать простые схемы.

Начнём с рассмотрения условий, которые необходимо выполнить, чтобы через
электрическую цепь шёл ток.

\subfile{sections/electronics-voltage}
\subfile{sections/electronics-circuits}
\subfile{sections/electronics-potential-difference}
\subfile{sections/electronics-resistance}
\subfile{sections/electronics-building-circuits}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Диалоги с компьютером}
\label{chapter:dialogues-with-computer}

\subfile{sections/dialogues-with-computer-title-image}
\subfile{sections/dialogues-with-computer-introduction}
\subfile{sections/dialogues-with-computer-algorithms}
\subfile{sections/dialogues-with-computer-arduino}
\subfile{sections/dialogues-with-computer-breadboard}
\subfile{sections/dialogues-with-computer-multimeter}

\newpage
\subfile{sections/dialogues-with-computer-arduino-ide}
\subfile{sections/dialogues-with-computer-program-structure}
\subfile{sections/dialogues-with-computer-memory}
\subfile{sections/dialogues-with-computer-control-flow}
\subfile{sections/dialogues-with-computer-wokwi}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Белый шум}

\subfile{sections/white-noise-introduction}
\subfile{sections/white-noise-signal-types}
\subfile{sections/white-noise-serial-port}
\subfile{sections/white-noise-analog-ports}
\subfile{sections/white-noise-adc}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Широтно-импульсная модуляция}
\label{chapter:pwm}

\subfile{sections/pwm-intro}
\subfile{sections/pwm-wavelength}
\subfile{sections/pwm-duty-cycle}
\subfile{sections/pwm-tasks}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Синтез музыки и технологии}

\subfile{sections/music-and-technology-synthesis-sound}
\subfile{sections/music-and-technology-synthesis-speaker}
\subfile{sections/music-and-technology-synthesis-rhythm}
\subfile{sections/music-and-technology-synthesis-harmony}
\subfile{sections/music-and-technology-synthesis-octave-system}
\subfile{sections/music-and-technology-synthesis-simple-melodies}
\subfile{sections/music-and-technology-synthesis-arrays}
\subfile{sections/music-and-technology-synthesis-two-dimensional-arrays}
\subfile{sections/music-and-technology-synthesis-staff}
\subfile{sections/music-and-technology-synthesis-rest}
\subfile{sections/music-and-technology-synthesis-dotted-notes}
\subfile{sections/music-and-technology-synthesis-flats-and-sharps}
\subfile{sections/music-and-technology-synthesis-musical-scale}
\subfile{sections/music-and-technology-synthesis-bass-clef}
\subfile{sections/music-and-technology-synthesis-music-band}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Язык общения машин}
\subfile{sections/communication-intro}
\subfile{sections/communication-serial-port}
\subfile{sections/communication-i2c}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Разработка игр}

\subfile{sections/game-dev-intro}
\subfile{sections/game-dev-lcd}
\subfile{sections/game-dev-genre-and-plot}
\subfile{sections/game-dev-player}
\subfile{sections/game-dev-buttons}
\subfile{sections/game-dev-game-map}
\subfile{sections/game-dev-sounds}
\subfile{sections/game-dev-graphics}
\subfile{sections/game-dev-animation}
\subfile{sections/game-dev-logic}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addcontentsline{toc}{chapter}{Предметный указатель}
\printindex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addcontentsline{toc}{chapter}{Словарь терминов}
\printglossaries

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addcontentsline{toc}{chapter}{Список примеров кода}
\renewcommand\listoflistingscaption{Список примеров кода}
\listoflistings

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\printbibliography[heading=bibintoc, title={Библиография}]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix

\subfile{sections/appendix-octaves}
\subfile{sections/appendix-prostokvashino-score}
\subfile{sections/appendix-twinkle-twinkle-little-star-01}
\subfile{sections/appendix-twinkle-twinkle-little-star-02}

\end{document}

